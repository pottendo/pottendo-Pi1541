<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>pi1541ui</title>
        <!-- Bulma CSS from CDN -->
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
        />


        <!-- Alpine.js Stores (load before Alpine) -->
<script defer src="stores/discStore.js"></script>
        <script defer src="stores/proxyStore.js"></script>
        <script defer src="stores/cacheStore.js"></script>
        <script defer src="stores/favouritesStore.js"></script>
        <script defer src="stores/csdbStore.js"></script>
        <script defer src="stores/toastStore.js"></script>
        <script defer src="stores/componentLoader.js"></script>

        <!-- iziToast -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/izitoast@1.4.0/dist/css/iziToast.min.css" />
        <script src="https://cdn.jsdelivr.net/npm/izitoast@1.4.0/dist/js/iziToast.min.js"></script>

        <!-- JSZip for inspecting zip archives -->
        <script defer src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

        <!-- Alpine.js from CDN -->
        <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

        <!-- Custom CSS -->
        <link rel="stylesheet" href="style.css" />
    </head>
    <body x-data="{ darkMode: localStorage.getItem('darkMode') === 'true', fontSize: parseInt(localStorage.getItem('fontSize')) || 100 }"
          :class="{ 'dark': darkMode }"
          x-init="
            document.documentElement.style.fontSize = fontSize + '%';
            $watch('darkMode', val => localStorage.setItem('darkMode', val));
            $watch('fontSize', val => { document.documentElement.style.fontSize = val + '%'; localStorage.setItem('fontSize', val); });
          ">
        <!-- Navigation -->
        <nav class="navbar" role="navigation" aria-label="main navigation">
            <div class="navbar-brand">
                <a class="navbar-item" href="#">
                    <svg width="28" height="28" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <!-- Floppy sleeve with hub hole punched out (evenodd) -->
                        <path d="M6,2 H58 V62 H6 V24 H9 V18 H6 Z M24,36 A8,8 0 1,0 40,36 A8,8 0 1,0 24,36 Z" fill="#222" fill-rule="evenodd" stroke="#111" stroke-width="1.5" stroke-linejoin="round"/>
                        <!-- Label area -->
                        <rect x="14" y="5" width="36" height="12" rx="1" fill="#f5f5dc" stroke="#999" stroke-width="0.5"/>
                        <!-- Label lines -->
                        <line x1="17" y1="9" x2="47" y2="9" stroke="#bbb" stroke-width="0.7"/>
                        <line x1="17" y1="13" x2="38" y2="13" stroke="#bbb" stroke-width="0.7"/>
                        <!-- Grey ring around hub hole -->
                        <circle cx="32" cy="36" r="8" fill="none" stroke="#777" stroke-width="1.5"/>
                        <!-- Index hole -->
                        <circle cx="22" cy="28" r="1.5" fill="#444"/>
                        <!-- Head access slot -->
                        <rect x="18" y="52" width="28" height="4" rx="1" fill="#444"/>
                    </svg>
                    <strong class="has-text-black is-size-4 ml-2">pi1541ui</strong>
                </a>
                <div class="navbar-item" style="margin-left: auto; gap: 0.25rem; display: flex;">
                    <button class="button is-small dark-mode-toggle" @click="fontSize = Math.max(fontSize - 10, 70)" title="Decrease font size">
                        <span class="icon is-small"><i class="fas fa-font" style="font-size: 0.45em;"></i></span>
                    </button>
                    <button class="button is-small dark-mode-toggle" @click="fontSize = Math.min(fontSize + 10, 150)" title="Increase font size">
                        <span class="icon is-small"><i class="fas fa-font" style="font-size: 1.3em;"></i></span>
                    </button>
                    <button class="button is-small dark-mode-toggle"
                            @click="darkMode = !darkMode"
                            :title="darkMode ? 'Switch to light mode' : 'Switch to dark mode'">
                        <span class="icon is-small">
                            <i :class="darkMode ? 'fas fa-lightbulb' : 'fas fa-moon'"></i>
                        </span>
                    </button>
                </div>
            </div>
        </nav>


        <!-- Main Content -->
        <section class="section py-4 px-3">
            <div class="container"
                 x-data="{ activeTab: localStorage.getItem('activeTab') || 'browser' }"
                 x-init="$watch('activeTab', val => localStorage.setItem('activeTab', val))">

                <!-- Pi Stats -->
                <div id="pi-stats-component"></div>

                <!-- Tab Navigation -->
                <div class="tabs is-boxed mb-0">
                    <ul>
                        <li :class="{ 'is-active': activeTab === 'browser' }">
                            <a @click="activeTab = 'browser'">
                                <span class="icon is-small"><i class="fas fa-folder-open"></i></span>
                                <span>Browser</span>
                            </a>
                        </li>
                        <li :class="{ 'is-active': activeTab === 'favourites' }">
                            <a @click="activeTab = 'favourites'">
                                <span class="icon is-small"><i class="fas fa-star"></i></span>
                                <span>Favourites</span>
                            </a>
                        </li>
                        <li :class="{ 'is-active': activeTab === 'csdb' }">
                            <a @click="activeTab = 'csdb'">
                                <span class="icon is-small"><i class="fas fa-database"></i></span>
                                <span>CSDb</span>
                            </a>
                        </li>
                        <li :class="{ 'is-active': activeTab === 'operations' }">
                            <a @click="activeTab = 'operations'">
                                <span class="icon is-small"><i class="fas fa-wrench"></i></span>
                                <span>Operations</span>
                            </a>
                        </li>
                        <li :class="{ 'is-active': activeTab === 'config' }">
                            <a @click="activeTab = 'config'">
                                <span class="icon is-small"><i class="fas fa-cog"></i></span>
                                <span>Config</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Tab Panels -->
                <div class="tab-content">
                    <div x-show="activeTab === 'browser'" id="file-browser-component"></div>
                    <div x-show="activeTab === 'favourites'" id="favourites-panel-component"></div>
                    <div x-show="activeTab === 'csdb'" id="csdb-search-component"></div>
                    <div x-show="activeTab === 'operations'" id="operations-panel-component"></div>
                    <div x-show="activeTab === 'config'" id="config-component"></div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="content has-text-centered">
                <p>
                    <strong>pi1541ui</strong> <span class="footer-sep">|</span>
                    <a href="https://github.com/pottendo/pottendo-Pi1541" target="_blank">pottendo-Pi1541</a> <span class="footer-sep">|</span>
                    <a href="https://cbm-pi1541.firebaseapp.com/" target="_blank">Pi1541</a>
                </p>
            </div>
        </footer>

        <!-- Font Awesome for icons -->
        <script
            defer
            src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"
        ></script>
        <script defer src="static/pi-font-loader.js"></script>
    </body>
</html>
